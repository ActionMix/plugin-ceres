{% extends getPartial('page-design') %}

{% set overrideSearchFilters = LayoutContainer.show("Ceres::Search.Filter", facets) %}

{% block PageBody %}

    {{ component( "Ceres::ItemList.Components.Filter.ItemFilterList") }}
    {{ component( "Ceres::ItemList.Components.Filter.ItemFilterTagList") }}
    {{ component( "Ceres::ItemList.Components.ItemList" ) }}

    <div class="categoriegrid page-content container-max">
        <div class="row m-t-1">
            <div class="col-xs-12">
                <h1 class="h2" id="searchPageTitle">{{ trans("Ceres::Template.itemSearchResults") }} {{ searchString }}</h1>
            </div>
        </div>

        <div class="list-controls m-b-3">
            <div class="list-controls-inner">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="list-wrapper">
                            {% include "Ceres::Category.Item.Partials.ItemSorting" with { 'sortingData': searchOptions.sorting, 'selectedSorting': itemSorting } %}

                            {% include "Ceres::Category.Item.Partials.ItemsPerPage" with { 'itemsPerPage': searchOptions.itemsPerPage, 'selectedValue': itemsPerPage } %}

                            {% if overrideSearchFilters | trim is empty %}
                                <item-filter-list :is-active="true" :facet-data="{{ facets | json_encode }}"></item-filter-list>
                            {% else %}
                                {{ overrideSearchFilters }}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <item-filter-tag-list></item-filter-tag-list>
        </div>

        {% if ceresConfig.pagination.position in ['top', 'top_bottom'] %}
            <div class="list-controls m-b-3 row">
                <div class="col-xs-12">
                    {% include "Ceres::Category.Item.Partials.Pagination" %}
                </div>
            </div>
        {% endif %}

        <div class="row">
            <div class="col-xs-12">

                <div id="twig-rendered-item-list" class="item-list-frame{% if ceresConfig.item.loadingAnimationType == "blur" %} blur-effect{% endif %}">

                    {% if ceresConfig.item.loadingAnimationType != "blur" %}
                        {% include "Ceres::ItemList.Partials.LoadingAnimation" %}
                    {% endif %}

                    <ul class="product-list row grid" :class="{ 'loading': $store.state.itemList.isLoading }">
                        {% for item in itemList %}
                            <li class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
                                {% include "Ceres::Category.Item.Partials.CategoryListItem" with { 'item': item, 'shippingCat': shippingCat } %}
                            </li>
                        {% endfor %}
                    </ul>
                </div>

                {# <div id="vue-rendered-item-list" class="item-list-frame"> #}
                    {# TODO ersetzten mit twig #}
                    {# 
                        <item-list :item-data="{{ itemList | json_encode }}" :total-items-data="{{ itemCountTotal }}" template="#vue-item-list"></item-list>
                    #}
                {# </div> #}

            </div>
        </div>

        {% if ceresConfig.pagination.position in ['bottom', 'top_bottom'] %}
            <div class="list-controls m-b-3 row">
                <div class="col-xs-12">
                    {% include "Ceres::Category.Item.Partials.Pagination" %}
                </div>
            </div>
        {% endif %}

    </div>

{% endblock %}

{% block PartialHead %}
<script type="application/ld+json">{"@context": "http://schema.org","@type": "WebSite","url": "{{ webstoreConfig.domainSsl }}","potentialAction":{"@type": "SearchAction","target": "{{ webstoreConfig.domainSsl }}/search?query={search_term}","query-input": "required name=search_term"}}</script>
    {% if isSearch %}
        <meta name="robots" content="{{ config("Ceres.meta.robots_search_result") }}">
        <title>{{ trans("Ceres::Template.itemSearchResults") }} {{ searchString }} | {{ trans("Ceres::Template.headerCompanyName") }}</title>
    {% endif %}
{% endblock %}
