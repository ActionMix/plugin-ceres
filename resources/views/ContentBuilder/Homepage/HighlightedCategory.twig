{% set lang = services.sessionStorage.getLang() %}

{% if widgetSettings.categoryId != null %}
    {% set category = services.category.get(widgetSettings.categoryId, lang) %}
    {% if category %}
        {% set data = {
            name: category.details[0].name,
            url: services.category.getURL(category, lang),
            imagePath: "documents/" ~ category.details[0].imagePath
        } %}
    {% endif %}
{% elseif widgetSettings.variationId != null %}
    {% set item = services.itemLoader.loadForTemplate('Ceres::Homepage.Homepage', itemLoaderPresets.items, {variationIds: [widgetSettings.variationId]}).documents[0].data %}
    {% set data = {
        name: item | itemName,
        url: item | itemURL,
        imagePath: (item.images | itemImages | orderByKey('position') | first).url
    } %}
{% endif %}

<div class="featured-categories m-y-2{% if widgetSettings.style == "large" %} sale-new{% endif %}">
    <div class="prop-xs-6-4 prop-md-3-1 prop-lg-3-1 prop-xl-3-1">
        <div class="prop-inner">
            <a class="featured-{% if widgetSettings.style == "large" %}sale-new{%else%}category{% endif %}" href="{{ data.url }}">
                {% if data.imagePath %}
                    <div class="featured-image{% if widgetSettings.imageSize == "contain" %} contain{% endif %}" style="background-image: url({{ data.imagePath }})"></div>
                    <!-- <img src="{{ data.imagePath }}" alt="{{ data.name }}"> -->
                {% endif %}
                <div class="featured-category-inner">
                    <h2 class="featured-category-headline">
                        <i class="fa fa-angle-double-right" aria-hidden="true"></i> {{ data.name }}
                    </h2>
                </div>
            </a>
        </div>
    </div>
</div>
